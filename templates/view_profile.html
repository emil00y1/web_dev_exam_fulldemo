{% include "_top_logged.html" %}

<main class="mx-4 h-full min-h-80vh" md="mx-6" lg="mx-8">
  
  <section class="d-grid p-content-center" md="cols-2 px-2" lg="px-16" xl="px-24">
        <h1 class="text-w-semibold" md="d-none">Hi <span class="text-t-capitalize">{{ user["user_name"] }}</span></h1>
        <div md="order-last w-full pa-16 d-flex flex-col a-items-center">
            <img src="{{ url_for('static', filename='avatars/' + user['user_avatar']) if user['user_avatar'] else url_for('static', filename='avatars/default_avatar.webp') }}" alt="User Avatar" class="w-full rounded-full shadow-md max-w-90 obj-f-cover aspect-ratio:1 d-none" md="d-block">
            <div class="mt-6 a-self-start w-full">
                {% if avatars|length > 0 %}
                    <p class="mb-4 text-w-semibold text-110">Change to a previous avatar</p>
                    <div class="d-flex gap-2 flex-wrap">
                        {% for avatar in avatars %}
                            {% if avatar.filename != user.user_avatar %}
                                <div class="p-relative w-12 h-12">
                                    <img 
                                        src="{{ url_for('static', filename='avatars/' + avatar.filename)}}"
                                        alt="Previous profile photo"
                                        class="rounded-full obj-f-cover w-full h-full shadow-md"
                                    />
                                    <form id="frm_avatar_{{ loop.index }}" class="d-none">
                                        <input type="hidden" name="filename" value="{{ avatar.filename }}">
                                    </form>
                                    <button 
                                        mix-put="/users/avatar/{{ user['user_pk'] }}"
                                        mix-data="#frm_avatar_{{ loop.index }}"
                                        class="p-absolute top-0 left-0 cursor-pointer w-full h-full opacity-0 rounded-full"
                                        hover="bg-c-black:+12 opacity-50"
                                        focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"
                                    >
                                        <span class="p-absolute text-c-charocoal:-14 bottom-(-1.25rem) left-0">Choose</span>
                                    </button>
                                </div>
                            {% endif %}
                        {% endfor %}
                        {% if user.user_avatar != 'default_avatar.webp' %}
                            <div class="p-relative w-12 h-12">
                                <img 
                                    src="{{ url_for('static', filename='avatars/default_avatar.webp')}}"
                                    alt="Default profile avatar"
                                    class="rounded-full obj-f-cover w-full h-full shadow-md"
                                />
                                <form id="frm_avatar_default" class="d-none">
                                    <input type="hidden" name="filename" value="default_avatar.webp">
                                </form>
                                <button 
                                    mix-put="/users/avatar/{{ user['user_pk'] }}"
                                    mix-data="#frm_avatar_default"
                                    class="p-absolute top-0 left-0 cursor-pointer w-full h-full opacity-0 rounded-full"
                                    hover="bg-c-black:+12 opacity-50"
                                    focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"
                                >
                                    <span class="p-absolute text-c-charocoal:-14 bottom-(-1.25rem) left-0">Choose</span>
                                </button>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            </div>
        </div>
    <div>
        <h1 class="d-none text-w-semibold" md="d-block">Hi <span class="text-t-capitalize">{{ user["user_name"] }}</span></h1>
        <h2 class="mt-6 text-w-semibold" md="text-110 mt-4">Your information</h2>
        <form id="frm_user_update" class="d-flex flex-col gap-4 w-min-content" enctype="multipart/form-data">
                <div class="d-flex flex-col">
                    <label for="user_avatar">Upload Profile Avatar</label>
                    <input
                        type="file"
                        id="user_avatar"
                        name="user_avatar"
                        accept="image/*"
                        focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"
                        class="cursor-pointer h-min-content py-4"
                    />
                    <span class="text-sm text-gray-600">Recommended: Square image, max 800x800px</span>
                </div>
        
                <div class="d-flex flex-col">
                    <label for="user_name">First Name</label>
                    <input
                        name="user_name"
                        id="user_name"
                        type="text"
                        mix-check="{{ x.USER_NAME_REGEX }}"
                        value="{{ user['user_name'] }}"
                        focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"

                    />
                </div>
        
                <div class="d-flex flex-col">
                    <label for="user_last_name">Last Name</label>
                    <input
                        name="user_last_name"
                        id="user_last_name"
                        type="text"
                        mix-check="{{ x.USER_LAST_NAME_REGEX }}"
                        value="{{ user['user_last_name'] }}"
                        focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"

                    />
                </div>
        
                <div class="d-flex flex-col">
                    <label for="user_email">Email</label>
                    <input
                        name="user_email"
                        id="user_email"
                        type="text"
                        mix-check="{{ x.REGEX_EMAIL }}"
                        value="{{ user['user_email'] }}"
                        focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"
                    />
                </div>
        
                <button 
                    mix-put="/users/{{ user['user_pk'] }}" 
                    mix-data="#frm_user_update"
                    class="text-c-white bg-c-tealblue:-5 cursor-pointer"
                    hover="bg-c-tealblue:-8"
                    focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"

                >
                    Update profile
                </button>
        </form>
        <button class="bg-none rounded-sm cursor-pointer text-80 px-0 py-1" hover="text-c-red:-14" title="Delete user" mix-get="/users/show-delete-modal/{{user['user_pk']}}" focus="outline-1 outline-c-tealblue:-6 outline-o-0.5"
        >
                Delete profile
        </button>
    </div>
 
  </section>
</main>

{% include "_bottom.html" %}
